<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>TESTPYL</title>
  <script src="https://apis.google.com/js/api.js"></script>
  <script>
    var CLIENT_ID = '1076564775870-mk83opo3aoj75oa0k8q2ianhbvorct5g.apps.googleusercontent.com';
    var API_KEY = 'VOTRE_API_KEY';
    var DISCOVERY_DOCS = ["https://sheets.googleapis.com/$discovery/rest?version=v4"];
    var SCOPES = "https://www.googleapis.com/auth/spreadsheets.readonly";

    function handleClientLoad() {
      gapi.load('client:auth2', initClient);
    }

    function initClient() {
      gapi.client.init({
        apiKey: API_KEY,
        clientId: CLIENT_ID,
        discoveryDocs: DISCOVERY_DOCS,
        scope: SCOPES
      }).then(function () {
        if (!gapi.auth2.getAuthInstance().isSignedIn.get()) {
          gapi.auth2.getAuthInstance().signIn().then(listValues);
        } else {
          listValues();
        }
      }, function(error) {
        console.error(JSON.stringify(error, null, 2));
      });
    }

    function listValues() {
      var spreadsheetId = 'VOTRE_SPREADSHEET_ID';
      var range = 'Sheet1!A1:D10';
      gapi.client.sheets.spreadsheets.values.get({
        spreadsheetId: spreadsheetId,
        range: range,
      }).then(function(response) {
        var range = response.result;
        if (range.values && range.values.length > 0) {
          var output = '<table border="1">';
          range.values.forEach(function(row) {
            output += '<tr>';
            row.forEach(function(cell) {
              output += '<td>' + cell + '</td>';
            });
            output += '</tr>';
          });
          output += '</table>';
          document.getElementById('content').innerHTML = output;
        } else {
          document.getElementById('content').innerHTML = 'Aucune donnée trouvée.';
        }
      }, function(response) {
        console.error('Erreur : ' + response.result.error.message);
      });
    }
  </script>
</head>
<body onload="handleClientLoad()">
<h1>Données de ma feuille Google Sheets</h1>
<div id="content">Chargement...</div>
</body>
</html>
